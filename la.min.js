function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=n():e.LayoutArchitect=n()}("undefined"!=typeof self?self:this,function(){return function(e,t,i,r){if(!e)throw new Error("Please provide a HTML element as first argument!");if(!t)throw new Error("Please provide a list of strings as a second argument!");"function"==typeof i&&(r=i,i=null);var l={};"object"!==_typeof(t)||Array.isArray(t)||(l=Object.assign({},t),t=Object.keys(t));var o,d=function(e){return document.createElement(e)},f=function(e,n,t){return e.setAttribute(n,t)},a=function(){var e=t.slice();if(!i)return e;var n=function n(t,e){return 0===e.children.length?t.push(e.id):e.children.forEach(function(e){return n(t,e)}),t}([],i);return e.filter(function(e){return-1===n.indexOf(e)})}(),n=d("DIV"),c=[],u=i||null;function h(e){return"object"===_typeof(l[e])?l[e].label||e:l[e]||e}function s(e){var n={id:e,children:[]};return"object"===_typeof(l[e])&&("function"==typeof r?r(n,l[e]):Object.assign(n,l[e])),n}function p(n,e,t,i){return e.map(function(e){var n=d("A");return f(n,"data-op",e[0]),f(n,"href","javascript:void(0);"),f(n,"class",e[2]),n.innerHTML=e[1],n.item=t,n.parent=i,n}).forEach(function(e){return n.appendChild(e)})}function v(n,e){var t,i,r=d("DIV");if(0===n.children.length)f(r,"data-id",n.id),f(r,"class","la-block "+(t=n.id,i="la-block-"+t,"object"===_typeof(l[t])&&"string"==typeof l[t].type?"la-block-"+l[t].type:i)),r.innerHTML='<div class="la-name">'+h(n.id)+"</div>",p(r,[["remove",'<svg width="14" height="14" viewBox="0 0 1792 1792"><path d="M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z"/></svg>',"la-remove"]],n,e);else{f(r,"class","la-block");var c="vertical"===n.direction?"rows":"columns";r.innerHTML='<div class="la-children la-children-'+c+'" style="grid-template-'+c+": repeat("+n.children.length+', 1fr);"></div>',n.children.forEach(function(e){return r.querySelector(".la-children").appendChild(v(e,n))})}return p(r,[["horizontal:left","","la-edge la-left"],["vertical:top","","la-edge la-top"],["vertical:bottom","","la-edge la-bottom"],["horizontal:right","","la-edge la-right"]],n,e),r}function g(){var i;return m((i=d("DIV"),a.forEach(function(e){var n=d("A"),t=h(e);f(n,"href","javascript:void(0);"),f(n,"data-op","select"),n.item=e,n.innerHTML='<svg width="10" height="10" viewBox="0 0 1792 1792"><path d="M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z"/></svg> '+t,i.appendChild(n)}),f(i,"class","la-selector"),i)),new Promise(function(t){o=function(e){var n=a.indexOf(e);-1<n&&a.splice(n,1),t(e)}})}function m(e){for(e=e||v(u);n.firstChild;)n.removeChild(n.firstChild);n.appendChild(e)}function y(){c.forEach(function(e){return e(u)})}function b(){g().then(function(e){u=s(e),m(),y()})}function q(n,e){if((e=e||u)&&e.id===n)return e;if(e&&e.children&&e.children.length){var t=e.children.findIndex(function(e){return e.id===n});if(-1<t)return{parent:e,index:t,item:e.children[t]};for(var i,r=0;r<e.children.length&&!(i=q(n,e.children[r]));r++);return i}}return f(n,"class","la"),n.addEventListener("click",function(e){var t,i,r,n=e.target.getAttribute("data-op"),c=e.target.item,l=e.target.parent;if(n&&c)if("remove"===n)!function(e,n){if(!e)return u=null,-1===a.indexOf(n.id)&&a.push(n.id);var t=e.children.findIndex(function(e){return e===n});-1<t&&(e.children.splice(t,1),1===e.children.length&&(0<e.children[0].children.length?(e.direction=e.children[0].direction,e.children=e.children[0].children):(e.id=e.children[0].id,e.children=[],delete e.direction)),a.push(n.id))}(l,c),u?m():b(),y();else if("select"===n)o(c);else{if(0===a.length)return;n=n.split(":"),(t=c,i=n[0],r="right"===n[1]||"bottom"===n[1]?"after":"before",g().then(function(e){return s(e)}).then(function(e){if(0===t.children.length)t.direction=i,t.children="after"===r?[s(t.id),e]:[e,s(t.id)],Object.keys(t).forEach(function(e){"direction"!==e&&"children"!==e&&delete t[e]});else{if(t.direction!==i){var n={direction:t.direction,children:t.children};t.children="after"===r?[n,e]:[e,n]}else"after"===r?t.children.push(e):t.children=[e].concat(t.children);t.direction=i}})).then(function(){m(),y()})}}),u?m():b(),e.appendChild(n),{onChange:function(e){c.push(e)},change:function(e){u=e,m()},get:function(){return u},clear:function(){u={},m()},find:function(e){return q(e)},replace:function(e,n,t){var i=q(e),r=q(n),c=a.indexOf(n);i&&i.parent&&r&&r.parent?(i.parent.children.splice(i.index,1,r.item),r.parent.children.splice(r.index,1,i.item),m(),y()):i&&i.parent&&-1<c&&!t?(i.parent.children.splice(i.index,1,s(n)),a.splice(c,1),m(),y()):i&&-1<c&&!t&&(u=s(n),a.splice(c,1),m(),y())},update:function(){m(),y()}}}});